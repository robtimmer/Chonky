"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@material-ui/core/styles"),n=e(require("deepmerge")),r=require("react"),o=e(r),i=require("react-dnd"),a=require("react-dnd-html5-backend"),l=require("react-intl"),c=require("react-jss"),s=require("react-redux"),d=e(require("shortid")),u=require("@reduxjs/toolkit"),f=e(require("fast-sort")),p=e(require("fuzzy-search")),m=e(require("redux-watch")),g=e(require("filesize")),h=e(require("exact-trie")),b=e(require("@material-ui/core/useMediaQuery")),y=e(require("classnames")),v=e(require("@material-ui/core/Box")),C=e(require("@material-ui/core/ClickAwayListener")),x=e(require("hotkeys-js")),S=e(require("@material-ui/core/Breadcrumbs")),I=e(require("@material-ui/core/Button")),F=e(require("@material-ui/core/Menu")),k=e(require("@material-ui/core/ListItemIcon")),w=e(require("@material-ui/core/ListItemText")),E=e(require("@material-ui/core/MenuItem")),D=e(require("@material-ui/core/Typography")),M=e(require("@material-ui/core/InputAdornment")),N=e(require("@material-ui/core/TextField")),A=e(require("react-virtualized-auto-sizer")),O=require("react-window"),z=e(require("@material-ui/core/ListSubheader"));function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return L(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var _,j={},B=function(e){var t=r.useRef(j);return t.current===j&&(t.current=e()),t.current},H=function(e){var t=r.useRef(e);return r.useEffect((function(){t.current=e}),[t,e]),t},P=function(){function e(){}return e.error=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).error.apply(e,["[Chonky runtime error]"].concat(n))},e.warn=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).warn.apply(e,["[Chonky runtime warning]"].concat(n))},e.debug=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).debug.apply(e,["[Chonky runtime debug]"].concat(n))},e.formatBullets=function(e){return"\n- "+e.join("\n- ")},e}(),K=function(){function e(){}return e.isDirectory=function(e){return!!e&&!0===e.isDir},e.isHidden=function(e){return!!e&&!0===e.isHidden},e.isSymlink=function(e){return!!e&&!0===e.isSymlink},e.isEncrypted=function(e){return!!e&&!0===e.isEncrypted},e.isClickable=function(e){return!!e},e.isOpenable=function(e){return!!e&&!1!==e.openable},e.isSelectable=function(e){return!!e&&!1!==e.selectable},e.isDraggable=function(e){return!!e&&!1!==e.draggable},e.isDroppable=function(e){return!(!e||(!e.isDir||!1===e.droppable)&&!0!==e.droppable)},e.isDndOpenable=function(t){return!(!e.isOpenable(t)||(!t.isDir||!1===t.dndOpenable)&&!0!==t.dndOpenable)},e.getModDate=function(t){return t&&null!=t.modDate?e.parseDate(t.modDate):null},e.parseDate=function(e){if("string"==typeof e||"number"==typeof e)try{return new Date(e)}catch(t){P.error("Could not convert provided string/number into a date: "+t.message+" ","Invalid value:",e)}return e instanceof Date&&!isNaN(e.getTime())?e:(P.warn("Unsupported date representation:",e),null)},e.getChildrenCount=function(e){return e&&"number"==typeof e.childrenCount?e.childrenCount:null},e}(),V=function(e,t){var n=[],r=[];if("folderChain"!==e&&"fileActions"!==e||t)if(Array.isArray(t)){for(var o=0,i=0,a=new Set,l=new Set,c=0;c<t.length;++c){var s=t[c];s?"object"!=typeof s?o++:!s.id||"fileActions"!==e&&!s.name?i++:a.has(s.id)?l.add(s.id):(a.add(s.id),n.push(s)):"fileActions"===e?o++:n.push(null)}if(o&&r.push("Detected "+o+' file(s) of invalid type. Remember that "files" array should contain either objects or nulls.'),i&&r.push("Detected "+i+' file(s) that are missing the required fields. Remember that file object should define an "id" and a "name".'),l.size>0){var d='"'+Array.from(l).join('", "')+'"';r.push("Detected "+l.size+" file IDs that are used multiple times. Remember that each file should have a unique IDs. The following IDs were seen multiple times: "+d)}}else r.push('Expected "'+e+'" prop to be an array, got "'+typeof t+'" instead.');if(r.length>0){var u,f,p="\n- "+r.join("\n- ");"folderChain"===e?(u="folder chain",f="files"):"fileActions"===e?(u="file actions",f="file actions"):(u="files",f="files"),P.error("Errors were detected when sanitizing the "+u+" array. Offending "+f+" were removed from the array. Summary of validation errors: "+p)}return{sanitizedArray:n,errorMessages:r}},q={ShowHiddenFiles:"show_hidden_files",ShowFoldersFirst:"show_folders_first",DarkMode:"dark_mode"};!function(e){e.ASC="asc",e.DESC="desc"}(_||(_={}));var W,G,U=function(e){return e.instanceId},Y=function(e){return e.fileActionMap},X=function(e){return e.fileActionIds},Z=function(e){return function(t){return Y(t)[e]}},Q=function(e){return e.toolbarItems},$=function(e){return e.contextMenuItems},J=function(e){return e.folderChain},ee=function(e){var t=J(e);return t.length>0?t[t.length-1]:null},te=function(e){var t=J(e);return t.length>1?t[t.length-2]:null},ne=function(e){return e.fileMap},re=function(e){return e.cleanFileIds},oe=function(e){return function(t){return e?ne(t)[e]:null}},ie=function(e){return e.hiddenFileIdMap},ae=function(e){return Object.keys(ie(e)).length},le=function(e){return e.searchString},ce=function(e){return e.selectionMap},se=function(e){return Object.keys(ce(e))},de=function(e){return se(e).length},ue=function(e){return function(t){return!!e&&!!ce(t)[e]}},fe=function(e){var t=ne(e);return Object.keys(ce(e)).map((function(e){return t[e]}))},pe=function(e){return function(t){var n;return null==(n=Ke(t,e))?void 0:n.length}},me=function(e){return e.fileViewConfig},ge=function(e){return e.sortActionId},he=function(e){return e.sortOrder},be=function(e){return function(t){return function(e){return e.optionMap}(t)[e]}},ye=function(e){return e.thumbnailGenerator},ve=function(e){return e.doubleClickDelay},Ce=function(e){return e.disableDragAndDrop},xe=function(e){return e.clearSelectionOnOutsideClick},Se=function(e){return e.contextMenuMounted},Ie=function(e){return e.contextMenuConfig},Fe=function(e){return e.fileActionMap},ke=function(e){return e.optionMap},we=function(e){return e.fileMap},Ee=function(e){return e.fileIds},De=function(e){return e.cleanFileIds},Me=function(e){return e.sortActionId},Ne=function(e){return e.sortOrder},Ae=function(e){return e.searchString},Oe=function(e){return e.lastClick},ze=function(e){return u.createSelector([Fe,e],(function(e,t){return t&&e[t]?e[t]:null}))},Te=function(e,t){return void 0===t&&(t=void 0),u.createSelector([ke],(function(n){var r=n[e];return void 0===r?t:r}))},Le=function(e){return u.createSelector([we,e],(function(e,t){return t.map((function(t){return t&&e[t]?e[t]:null}))}))},Re=u.createSelector([Ee,Ne,Le(Ee),ze(Me),Te(q.ShowFoldersFirst,!1)],(function(e,t,n,r,o){if(!r)return e;var i,a=function(e){return function(t){return e(t)}},l=[];return o&&l.push({desc:a(K.isDirectory)}),r.sortKeySelector&&l.push(((i={})[t===_.ASC?"asc":"desc"]=a(r.sortKeySelector),i)),0===l.length?e:f([].concat(n)).by(l).map((function(e){return e?e.id:null}))})),_e=u.createSelector([Le(De)],(function(e){return new p(e,["name"],{caseSensitive:!1})})),je=u.createSelector([De,Ae,_e],(function(e,t,n){return t?n.search(t).map((function(e){return e.id})):e})),Be=u.createSelector([je,Le(De),Te(q.ShowHiddenFiles)],(function(e,t,n){var r=new Set(e),o={};return t.forEach((function(e){e&&(r.has(e.id)?!n&&K.isHidden(e)&&(o[e.id]=!0):o[e.id]=!0)})),o})),He={getFileActionMap:Fe,getOptionMap:ke,getFileMap:we,getFileIds:Ee,getCleanFileIds:De,getSortActionId:Me,getSortOrder:Ne,getSearchString:Ae,_getLastClick:Oe,getSortedFileIds:Re,getSearcher:_e,getSearchFilteredFileIds:je,getHiddenFileIdMap:Be,getDisplayFileIds:u.createSelector([Re,Be],(function(e,t){return e.filter((function(e){return!e||!t[e]}))})),getLastClickIndex:u.createSelector([Oe,Re],(function(e,t){return!e||e.index>t.length-1||e.fileId!=t[e.index]?null:e.index})),makeGetAction:ze,makeGetOptionValue:Te,makeGetFiles:Le},Pe=function(e,t){return!!ce(e)[t.id]},Ke=function(e,t){return function(e){return function(t){var n=t.fileActionMap[e];if(n&&n.requiresSelection)return function(e){for(var t=e.fileMap,n=e.selectionMap,r=Object.keys(n).map((function(e){return t[e]})),o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=i.reduce((function(e,t){return t?e.filter(t):e}),r);return l}(t,n.fileFilter)}}(t)(e)},Ve=function(e,t){return function(n){var r,o=V("fileActions",e),i=o.sanitizedArray,a=o.errorMessages;if(Array.isArray(t)){var l=new Set(t);r=it.filter((function(e){return!l.has(e.id)}))}else r=t?[]:it;var c=function(){for(var e,t=new Set,n=function(e){return!!t.add(e.id)},r=function(e){return!t.has(e.id)},o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=i.map((function(e){var t=e.filter(r);return t.map(n),t}));return(e=new Array).concat.apply(e,l)}(i,ot,r),s={};c.map((function(e){return e.option?s[e.option.id]=e.option.defaultValue:null})),n(ct.setRawFileActions(e)),n(ct.setFileActionsErrorMessages(a)),n(ct.setFileActions(c)),n(ct.setOptionDefaults(s)),n(qe(c))}},qe=function(e){return function(t){for(var n,r=new Set([rt.OpenParentFolder.id]),o=[],i={},a=[],l={},c=function(e,t,n){if(t[n])return t[n];var r={name:n,fileActionIds:[]};return e.push(r),t[n]=r,r},s=R(e);!(n=s()).done;){var d=n.value,u=d.button;u&&(u.toolbar&&!r.has(d.id)&&(u.group?c(o,i,u.group).fileActionIds.push(d.id):o.push(d.id)),u.contextMenu&&(u.group?c(a,l,u.group).fileActionIds.push(d.id):a.push(d.id)))}t(ct.updateFileActionMenuItems([o,a]))}},We=function(e){return function(t,n){var r=n(),o=e?r.fileActionMap[e]:null;o&&o.fileViewConfig&&t(ct.setFileViewConfig(o.fileViewConfig))}},Ge=function(e){return function(t,n){if(e){var r=n(),o=r.fileActionMap[e];if(o&&o.sortKeySelector){var i=r.sortOrder===_.ASC?_.DESC:_.ASC;r.sortActionId!==e&&(i=_.ASC),t(ct.setSort({actionId:e,order:i}))}}}},Ue=function(e){return function(t,n){P.debug("FILE ACTION DISPATCH: ["+e.id+"]","data:",e);var r=n(),o=Y(r)[e.id],i=function(e){return e.externalFileActionHandler}(r);o?i&&Promise.resolve(i(e)).catch((function(e){return P.error("User-defined file action handler threw an error: "+e.message)})):P.warn('Internal components dispatched the "'+e.id+'" file action, but such action was not registered.')}},Ye=function(e,t){return function(n,r){P.debug("FILE ACTION REQUEST: ["+e.id+"]","action:",e,"payload:",t);var o=r(),i=U(o);Y(o)[e.id]||P.warn('The action "'+e.id+'" was requested, but it is not registered. The action will still be dispatched, but this might indicate a bug in the code. Please register your actions by passing them to "fileActions" prop.');var a=fe(o),l=e.fileFilter?a.filter(e.fileFilter):a;if(!e.requiresSelection||0!==l.length){var c={instanceId:i,selectedFiles:a,selectedFilesForAction:l,contextMenuTriggerFile:function(e){var t,n=Ie(e);return n&&n.triggerFileId&&null!=(t=ne(e)[n.triggerFileId])?t:null}(o)};e.sortKeySelector&&n(Ge(e.id));var s=e.fileViewConfig;s&&n(ct.setFileViewConfig(s));var d=e.option;d&&n(ct.toggleOption(d.id)),e.selectionTransform&&n(function(e){return function(t,n){var r=e.selectionTransform;if(r){var o=n(),i=new Set(Object.keys(ce(o))),a=new Set(Object.keys(ie(o))),l=r({prevSelection:i,fileIds:re(o),fileMap:ne(o),hiddenFileIds:a});l&&t(0===l.size?ct.clearSelection():ct.selectFiles({fileIds:Array.from(l),reset:!0}))}}}(e));var u=e.effect,f=void 0;if(u)try{f=u({action:e,payload:t,state:c,reduxDispatch:n,getReduxState:r})}catch(t){P.error("User-defined effect function for action "+e.id+" threw an error: "+t.message)}return Promise.resolve(f).then((function(r){Xe(n,{id:e.id,action:e,payload:t,state:c},r)})).catch((function(r){P.error("User-defined effect function for action "+e.id+" returned a promise that was rejected: "+r.message),Xe(n,{id:e.id,action:e,payload:t,state:c},void 0)}))}P.warn('Internal components requested the "'+e.id+'" file action, but the selection for this action was empty. This might a bug in the code of the presentational components.')}},Xe=function(e,t,n){!0===n||e(Ue(t))};(W=exports.FileViewMode||(exports.FileViewMode={})).List="list",W.Compact="compact",W.Grid="grid",(G=exports.ChonkyIconName||(exports.ChonkyIconName={})).loading="loading",G.dropdown="dropdown",G.placeholder="placeholder",G.dndDragging="dndDragging",G.dndCanDrop="dndCanDrop",G.dndCannotDrop="dndCannotDrop",G.openFiles="openFiles",G.openParentFolder="openParentFolder",G.copy="copy",G.paste="paste",G.share="share",G.search="search",G.selectAllFiles="selectAllFiles",G.clearSelection="clearSelection",G.sortAsc="sortAsc",G.sortDesc="sortDesc",G.toggleOn="toggleOn",G.toggleOff="toggleOff",G.list="list",G.compact="compact",G.smallThumbnail="smallThumbnail",G.largeThumbnail="largeThumbnail",G.folder="folder",G.folderCreate="folderCreate",G.folderOpen="folderOpen",G.folderChainSeparator="folderChainSeparator",G.download="download",G.upload="upload",G.trash="trash",G.fallbackIcon="fallbackIcon",G.symlink="symlink",G.hidden="hidden",G.file="file",G.license="license",G.code="code",G.config="config",G.model="model",G.database="database",G.text="text",G.archive="archive",G.image="image",G.video="video",G.info="info",G.key="key",G.lock="lock",G.music="music",G.terminal="terminal",G.users="users",G.linux="linux",G.ubuntu="ubuntu",G.windows="windows",G.rust="rust",G.python="python",G.nodejs="nodejs",G.php="php",G.git="git",G.adobe="adobe",G.pdf="pdf",G.excel="excel",G.word="word",G.flash="flash";var Ze,Qe=function(e,t){if(void 0!==e.__payloadType&&(e.hotkeys||e.button)){var n='Invalid definition was provided for file action "'+e.id+'". Actions that specify hotkeys or buttons cannot define a payload type. If your application requires this functionality, define two actions and chain them using effects.';throw P.error(n),new Error(n)}return e.effect=t,e},$e=function e(t,n){return t?n(t)?t:t.parentElement?e(t.parentElement,n):null:t},Je=function(e,t,n){return n?typeof e===n?e:t:void 0!==e?e:t},et={MouseClickFile:Qe({id:"mouse_click_file",__payloadType:{}},(function(e){var t,n=e.payload,r=e.reduxDispatch,o=e.getReduxState;if("double"===n.clickType)K.isOpenable(n.file)&&r(Ye(rt.OpenFiles,{targetFile:n.file,files:[n.file]}));else{var i=o().disableSelection;if(K.isSelectable(n.file)&&!i)if(n.ctrlKey)r(ct.toggleSelection({fileId:n.file.id,exclusive:!1})),r(ct.setLastClickIndex({index:n.fileDisplayIndex,fileId:n.file.id}));else if(n.shiftKey){var a=He.getLastClickIndex(o());if("number"==typeof a){var l=a,c=n.fileDisplayIndex;if(l>c){var s=[c,l];l=s[0],c=s[1]}r((t={rangeStart:l,rangeEnd:c},function(e,n){var r=n();if(!r.disableSelection){var o=He.getDisplayFileIds(r).slice(t.rangeStart,t.rangeEnd+1).filter((function(e){return e&&K.isSelectable(r.fileMap[e])}));e(ct.selectFiles({fileIds:o,reset:!!t.reset}))}}))}else r(ct.toggleSelection({fileId:n.file.id,exclusive:!1})),r(ct.setLastClickIndex({index:n.fileDisplayIndex,fileId:n.file.id}))}else r(ct.toggleSelection({fileId:n.file.id,exclusive:!0})),r(ct.setLastClickIndex({index:n.fileDisplayIndex,fileId:n.file.id}));else n.ctrlKey||i||r(ct.clearSelection()),r(ct.setLastClickIndex({index:n.fileDisplayIndex,fileId:n.file.id}))}})),KeyboardClickFile:Qe({id:"keyboard_click_file",__payloadType:{}},(function(e){var t=e.payload,n=e.reduxDispatch,r=e.getReduxState;n(ct.setLastClickIndex({index:t.fileDisplayIndex,fileId:t.file.id})),t.enterKey?0===de(r())&&n(Ye(rt.OpenFiles,{targetFile:t.file,files:[t.file]})):t.spaceKey&&K.isSelectable(t.file)&&n(ct.toggleSelection({fileId:t.file.id,exclusive:t.ctrlKey}))})),StartDragNDrop:Qe({id:"start_drag_n_drop",__payloadType:{}},(function(e){var t=e.reduxDispatch,n=e.payload.draggedFile;Pe((0,e.getReduxState)(),n)||K.isSelectable(n)&&t(ct.selectFiles({fileIds:[n.id],reset:!0}))})),EndDragNDrop:Qe({id:"end_drag_n_drop",__payloadType:{}},(function(e){var t=e.payload,n=e.reduxDispatch;if(!Pe((0,e.getReduxState)(),t.destination)){var r=t.selectedFiles;n(Ye(rt.MoveFiles,T({},t,{files:r.length>0?r:[t.draggedFile]})))}})),MoveFiles:Qe({id:"move_files",__payloadType:{}}),ChangeSelection:Qe({id:"change_selection",__payloadType:{}}),OpenFiles:Qe({id:"open_files",__payloadType:{}}),OpenParentFolder:Qe({id:"open_parent_folder",hotkeys:["backspace"],button:{name:"Go up a directory",toolbar:!0,contextMenu:!1,icon:exports.ChonkyIconName.openParentFolder,iconOnly:!0}},(function(e){var t=e.reduxDispatch,n=te((0,e.getReduxState)());K.isOpenable(n)?t(Ye(rt.OpenFiles,{targetFile:n,files:[n]})):P.warn("Open parent folder effect was triggered  even though the parent folder is not openable. This indicates a bug in presentation components.")})),OpenFileContextMenu:Qe({id:"open_file_context_menu",__payloadType:{}},(function(e){var t,n,r=e.payload,o=e.reduxDispatch,i=e.getReduxState,a=(t=i(),(n=r.triggerFileId)?ne(t)[n]:null);a&&(Pe(i(),a)||(K.isSelectable(a)?o(ct.selectFiles({fileIds:[r.triggerFileId],reset:!0})):o(ct.clearSelection()))),o(ct.showContextMenu({triggerFileId:r.triggerFileId,mouseX:r.clientX-2,mouseY:r.clientY-4}))}))},tt={OpenSelection:Qe({id:"open_selection",hotkeys:["enter"],requiresSelection:!0,fileFilter:K.isOpenable,button:{name:"Open selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.openFiles}},(function(e){(0,e.reduxDispatch)(Ye(et.OpenFiles,{files:e.state.selectedFilesForAction}))})),SelectAllFiles:Qe({id:"select_all_files",hotkeys:["ctrl+a"],button:{name:"Select all files",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.selectAllFiles},selectionTransform:function(e){var t=e.fileIds,n=e.hiddenFileIds,r=new Set;return t.map((function(e){n.has(e)||r.add(e)})),r}}),ClearSelection:Qe({id:"clear_selection",hotkeys:["escape"],button:{name:"Clear selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.clearSelection},selectionTransform:function(e){return 0===e.prevSelection.size?null:new Set}}),EnableListView:Qe({id:"enable_list_view",fileViewConfig:{mode:exports.FileViewMode.List,entryHeight:30},button:{name:"Switch to List view",toolbar:!0,icon:exports.ChonkyIconName.list,iconOnly:!0}}),EnableCompactView:Qe({id:"enable_compact_view",fileViewConfig:{mode:exports.FileViewMode.Compact,entryHeight:40,entryWidth:220},button:{name:"Switch to Compact view",toolbar:!0,icon:exports.ChonkyIconName.compact,iconOnly:!0}}),EnableGridView:Qe({id:"enable_grid_view",fileViewConfig:{mode:exports.FileViewMode.Grid,entryWidth:165,entryHeight:130},button:{name:"Switch to Grid view",toolbar:!0,icon:exports.ChonkyIconName.smallThumbnail,iconOnly:!0}}),SortFilesByName:Qe({id:"sort_files_by_name",sortKeySelector:function(e){return e?e.name.toLowerCase():void 0},button:{name:"Sort by name",toolbar:!0,group:"Options"}}),SortFilesBySize:Qe({id:"sort_files_by_size",sortKeySelector:function(e){return e?e.size:void 0},button:{name:"Sort by size",toolbar:!0,group:"Options"}}),SortFilesByDate:Qe({id:"sort_files_by_date",sortKeySelector:function(e){return e?e.modDate:void 0},button:{name:"Sort by date",toolbar:!0,group:"Options"}}),ToggleHiddenFiles:Qe({id:"toggle_hidden_files",hotkeys:["ctrl+h"],option:{id:q.ShowHiddenFiles,defaultValue:!0},button:{name:"Show hidden files",toolbar:!0,group:"Options"}}),ToggleShowFoldersFirst:Qe({id:"toggle_show_folders_first",option:{id:q.ShowFoldersFirst,defaultValue:!0},button:{name:"Show folders first",toolbar:!0,group:"Options"}}),FocusSearchInput:Qe({id:"focus_search_input",hotkeys:["ctrl+f"]},(function(e){var t=(0,e.getReduxState)().focusSearchInput;t&&t()})),ToggleDarkMode:Qe({id:"enable_dark_mode",option:{id:q.DarkMode,defaultValue:!1},button:{name:"Enable dark mode",toolbar:!0,icon:exports.ChonkyIconName.list,iconOnly:!0}})},nt={CopyFiles:Qe({id:"copy_files",requiresSelection:!0,hotkeys:["ctrl+c"],button:{name:"Copy selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.copy}}),CreateFolder:Qe({id:"create_folder",button:{name:"Create folder",toolbar:!0,tooltip:"Create a folder",icon:exports.ChonkyIconName.folderCreate}}),UploadFiles:Qe({id:"upload_files",button:{name:"Upload files",toolbar:!0,tooltip:"Upload files",icon:exports.ChonkyIconName.upload}}),DownloadFiles:Qe({id:"download_files",requiresSelection:!0,button:{name:"Download files",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.download}}),DeleteFiles:Qe({id:"delete_files",requiresSelection:!0,hotkeys:["delete"],button:{name:"Delete files",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.trash}})},rt=T({},et,tt,nt),ot=[rt.MouseClickFile,rt.KeyboardClickFile,rt.StartDragNDrop,rt.EndDragNDrop,rt.MoveFiles,rt.ChangeSelection,rt.OpenFiles,rt.OpenParentFolder,rt.OpenFileContextMenu],it=[rt.OpenSelection,rt.SelectAllFiles,rt.ClearSelection,rt.EnableListView,rt.EnableGridView,rt.SortFilesByName,rt.SortFilesBySize,rt.SortFilesByDate,rt.ToggleHiddenFiles,rt.ToggleShowFoldersFirst,rt.FocusSearchInput],at={instanceId:"CHONKY_INVALID_ID",externalFileActionHandler:null,rawFileActions:[],fileActionsErrorMessages:[],fileActionMap:{},fileActionIds:[],toolbarItems:[],contextMenuItems:[],rawFolderChain:null,folderChainErrorMessages:[],folderChain:[],rawFiles:[],filesErrorMessages:[],fileMap:{},fileIds:[],cleanFileIds:[],sortedFileIds:[],hiddenFileIdMap:{},focusSearchInput:null,searchString:"",searchMode:"currentFolder",selectionMap:{},disableSelection:!1,fileViewConfig:rt.EnableGridView.fileViewConfig,sortActionId:null,sortOrder:_.ASC,optionMap:{},thumbnailGenerator:null,doubleClickDelay:300,disableDragAndDrop:!1,clearSelectionOnOutsideClick:!0,lastClick:null,contextMenuMounted:!1,contextMenuConfig:null},lt=u.createSlice({name:"root",initialState:at,reducers:{setExternalFileActionHandler:function(e,t){var n;e.externalFileActionHandler=null!=(n=t.payload)?n:null},setRawFileActions:function(e,t){e.rawFileActions=t.payload},setFileActionsErrorMessages:function(e,t){e.fileActionsErrorMessages=t.payload},setFileActions:function(e,t){var n={};t.payload.map((function(e){return n[e.id]=e}));var r=t.payload.map((function(e){return e.id}));e.fileActionMap=n,e.fileActionIds=r},updateFileActionMenuItems:function(e,t){var n=t.payload;e.toolbarItems=n[0],e.contextMenuItems=n[1]},setRawFolderChain:function(e,t){var n=t.payload,r=V("folderChain",n),o=r.sanitizedArray,i=r.errorMessages;e.rawFolderChain=n,e.folderChain=o,e.folderChainErrorMessages=i},setRawFiles:function(e,t){var n=t.payload,r=V("files",n),o=r.sanitizedArray,i=r.errorMessages;e.rawFiles=n,e.filesErrorMessages=i;var a={};o.forEach((function(e){e&&(a[e.id]=e)}));var l=o.map((function(e){return e?e.id:null})),c=l.filter((function(e){return!!e}));e.fileMap=a,e.fileIds=l,e.cleanFileIds=c;for(var s=0,d=Object.keys(e.selectionMap);s<d.length;s++){var u=d[s];a[u]||delete e.selectionMap[u]}},setSortedFileIds:function(e,t){e.sortedFileIds=t.payload},setHiddenFileIds:function(e,t){e.hiddenFileIdMap=t.payload;for(var n=0,r=Object.keys(e.selectionMap);n<r.length;n++){var o=r[n];e.hiddenFileIdMap[o]&&delete e.selectionMap[o]}},setFocusSearchInput:function(e,t){e.focusSearchInput=t.payload},setSearchString:function(e,t){e.searchString=t.payload},selectAllFiles:function(e){e.fileIds.filter((function(t){return t&&K.isSelectable(e.fileMap[t])})).map((function(t){return t?e.selectionMap[t]=!0:null}))},selectFiles:function(e,t){e.disableSelection||(t.payload.reset&&(e.selectionMap={}),t.payload.fileIds.filter((function(t){return t&&K.isSelectable(e.fileMap[t])})).map((function(t){return e.selectionMap[t]=!0})))},toggleSelection:function(e,t){if(!e.disableSelection){var n=!!e.selectionMap[t.payload.fileId];t.payload.exclusive&&(e.selectionMap={}),n?delete e.selectionMap[t.payload.fileId]:K.isSelectable(e.fileMap[t.payload.fileId])&&(e.selectionMap[t.payload.fileId]=!0)}},clearSelection:function(e){e.disableSelection||0!==Object.keys(e.selectionMap).length&&(e.selectionMap={})},setSelectionDisabled:function(e,t){e.disableSelection=t.payload,0!==Object.keys(e.selectionMap).length&&(e.selectionMap={})},setFileViewConfig:function(e,t){e.fileViewConfig=t.payload},setSort:function(e,t){e.sortActionId=t.payload.actionId,e.sortOrder=t.payload.order},setOptionDefaults:function(e,t){for(var n=0,r=Object.keys(t.payload);n<r.length;n++){var o=r[n];o in e.optionMap||(e.optionMap[o]=t.payload[o])}},toggleOption:function(e,t){e.optionMap[t.payload]=!e.optionMap[t.payload]},setThumbnailGenerator:function(e,t){e.thumbnailGenerator=t.payload},setDoubleClickDelay:function(e,t){e.doubleClickDelay=t.payload},setDisableDragAndDrop:function(e,t){e.disableDragAndDrop=t.payload},setClearSelectionOnOutsideClick:function(e,t){e.clearSelectionOnOutsideClick=t.payload},setLastClickIndex:function(e,t){e.lastClick=t.payload},setContextMenuMounted:function(e,t){e.contextMenuMounted=t.payload},showContextMenu:function(e,t){e.contextMenuConfig=t.payload},hideContextMenu:function(e){e.contextMenuConfig&&(e.contextMenuConfig=null)}}}),ct=lt.actions,st=lt.reducer,dt=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=r.useCallback((function(t){return e.apply(void 0,n)(t)}),[e].concat(n));return s.useSelector(i)},ut=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=s.useDispatch();r.useEffect((function(){i(e.apply(void 0,n))}),[i,e].concat(n))},ft=function(e,t){var n=s.useDispatch();r.useEffect((function(){return n(e(t))}),[n,e,t])},pt=function(){return o.createElement("span",{title:"No icon component found. Please follow Chonky installation instructions to provide a pre-made icon component (or a custom icon)."},"⚠️")},mt={fileActions:null,onFileAction:null,thumbnailGenerator:null,doubleClickDelay:300,disableSelection:!1,disableDefaultFileActions:!1,disableDragAndDrop:!1,disableDragAndDropProvider:!1,defaultSortActionId:rt.SortFilesByName.id,defaultFileViewActionId:rt.EnableGridView.id,clearSelectionOnOutsideClick:!0,iconComponent:pt,darkMode:!1,i18n:{}};(Ze=exports.I18nNamespace||(exports.I18nNamespace={})).Toolbar="toolbar",Ze.FileList="fileList",Ze.FileEntry="fileEntry",Ze.FileContextMenu="contextMenu",Ze.FileActions="actions",Ze.FileActionGroups="actionGroups";var gt=function(e,t){return"chonky."+e+"."+t},ht=function(e,t){return"chonky."+exports.I18nNamespace.FileActions+"."+e+"."+t},bt=function(e){var t=l.useIntl();return r.useMemo((function(){var n,r;if(!e)return{buttonName:"",buttonTooltip:void 0};var o,i=t.formatMessage({id:ht(e.id,"button.name"),defaultMessage:null==(n=e.button)?void 0:n.name}),a=void 0;return null!=(r=e.button)&&r.tooltip&&(a=t.formatMessage({id:ht(e.id,"button.tooltip"),defaultMessage:null==(o=e.button)?void 0:o.tooltip})),{buttonName:i,buttonTooltip:a}}),[e,t])},yt=function(e){var t=l.useIntl(),n=r.useContext(Ct);return r.useMemo((function(){return{fileModDateString:n.formatFileModDate(t,e),fileSizeString:n.formatFileSize(t,e)}}),[e,n,t])},vt={formatFileModDate:function(e,t){var n=K.getModDate(t);return n?e.formatDate(n,{dateStyle:"medium",timeStyle:"short"}):null},formatFileSize:function(e,t){if(!t||"number"!=typeof t.size)return null;var n=g(t.size,{bits:!1,output:"object"});return"B"===n.symbol?Math.round(n.value/10)/100+" KB":"KB"===n.symbol?Math.round(n.value)+" "+n.symbol:n.value+" "+n.symbol}},Ct=r.createContext(vt),xt=r.createContext(pt),St=["3g2","3gp","3gpp","asf","asx","avi","dvb","f4v","fli","flv","fvt","h261","h263","h264","jpgm","jpgv","jpm","m1v","m2v","m4u","m4v","mj2","mjp2","mk3d","mks","mkv","mng","mov","movie","mp4","mp4v","mpe","mpeg","mpg","mpg4","mxu","ogv","pyv","qt","smv","ts","uvh","uvm","uvp","uvs","uvu","uvv","uvvh","uvvm","uvvp","uvvs","uvvu","uvvv","viv","vob","webm","wm","wmv","wmx","wvx"],It=["3ds","apng","azv","bmp","bmp","btif","cgm","cmx","djv","djvu","drle","dwg","dxf","emf","exr","fbs","fh","fh4","fh5","fh7","fhc","fits","fpx","fst","g3","gif","heic","heics","heif","heifs","ico","ico","ief","jls","jng","jp2","jpe","jpeg","jpf","jpg","jpg2","jpm","jpx","jxr","ktx","mdi","mmr","npx","pbm","pct","pcx","pcx","pgm","pic","png","pnm","ppm","psd","pti","ras","rgb","rlc","sgi","sid","sub","svg","svgz","t38","tap","tfx","tga","tif","tiff","uvg","uvi","uvvg","uvvi","vtf","wbmp","wdp","webp","wmf","xbm","xif","xpm","xwd"],Ft=["3gpp","aac","adp","aif","aifc","aiff","au","caf","dra","dts","dtshd","ecelp4800","ecelp7470","ecelp9600","eol","flac","kar","lvp","m2a","m3a","m3u","m4a","m4a","mid","midi","mka","mp2","mp2a","mp3","mp3","mp4a","mpga","oga","ogg","pya","ra","ra","ram","rip","rmi","rmp","s3m","sil","snd","spx","uva","uvva","wav","wav","wav","wax","weba","wma","xm"],kt=["#bbbbbb","#d65c5c","#d6665c","#d6705c","#d67a5c","#d6855c","#d68f5c","#d6995c","#d6a35c","#d6ad5c","#d6b85c","#d6c25c","#d6cc5c","#d6d65c","#ccd65c","#c2d65c","#b8d65c","#add65c","#a3d65c","#99d65c","#8fd65c","#85d65c","#7ad65c","#70d65c","#66d65c","#5cd65c","#5cd666","#5cd670","#5cd67a","#5cd685","#5cd68f","#5cd699","#5cd6a3","#5cd6ad","#5cd6b8","#5cd6c2","#5cd6cc","#5cd6d6","#5cccd6","#5cc2d6","#5cb8d6","#5cadd6","#5ca3d6","#5c99d6","#5c8fd6","#5c85d6","#5c7ad6","#5c70d6","#5c66d6","#5c5cd6","#665cd6","#705cd6","#7a5cd6","#855cd6","#8f5cd6","#995cd6","#a35cd6","#ad5cd6","#b85cd6","#c25cd6","#cc5cd6","#d65cd6","#d65ccc","#d65cc2","#d65cb8","#d65cad","#d65ca3","#d65c99","#d65c8f","#d65c85","#d65c7a","#d65c70","#d65c66"],wt=["#777","#8f3d3d","#8f443d","#8f4b3d","#8f523d","#8f583d","#8f5f3d","#8f663d","#8f6d3d","#8f743d","#8f7a3d","#8f813d","#8f883d","#8f8f3d","#888f3d","#818f3d","#7a8f3d","#748f3d","#6d8f3d","#668f3d","#5f8f3d","#588f3d","#528f3d","#4b8f3d","#448f3d","#3d8f3d","#3d8f44","#3d8f4b","#3d8f52","#3d8f58","#3d8f5f","#3d8f66","#3d8f6d","#3d8f74","#3d8f7a","#3d8f81","#3d8f88","#3d8f8f","#3d888f","#3d818f","#3d7a8f","#3d748f","#3d6d8f","#3d668f","#3d5f8f","#3d588f","#3d528f","#3d4b8f","#3d448f","#3d3d8f","#443d8f","#4b3d8f","#523d8f","#583d8f","#5f3d8f","#663d8f","#6d3d8f","#743d8f","#7a3d8f","#813d8f","#883d8f","#8f3d8f","#8f3d88","#8f3d81","#8f3d7a","#8f3d74","#8f3d6d","#8f3d66","#8f3d5f","#8f3d58","#8f3d52","#8f3d4b","#8f3d44"],Et=function(){for(var e=0,t=[[exports.ChonkyIconName.license,["license"]],[exports.ChonkyIconName.config,["sfk","ini","yml","toml","iml"]],[exports.ChonkyIconName.model,["3ds","obj","ply","fbx"]],[exports.ChonkyIconName.database,["csv","json","sql","sqlite","sqlite3","npy","npz","rec","idx","hdf5"]],[exports.ChonkyIconName.text,["txt","md","mdx"]],[exports.ChonkyIconName.archive,["zip","rar","tar","tar.gz","7z"]],[exports.ChonkyIconName.image,It],[exports.ChonkyIconName.video,St],[exports.ChonkyIconName.code,["html","php","css","sass","scss","less","cpp","h","hpp","c","xml"]],[exports.ChonkyIconName.info,["bib","readme","nfo"]],[exports.ChonkyIconName.key,["pem","pub"]],[exports.ChonkyIconName.lock,["lock","lock.json","shrinkwrap.json"]],[exports.ChonkyIconName.music,Ft],[exports.ChonkyIconName.terminal,["run","sh"]],[exports.ChonkyIconName.trash,[".Trashes"]],[exports.ChonkyIconName.users,["authors","contributors"]],[exports.ChonkyIconName.linux,["AppImage"]],[exports.ChonkyIconName.ubuntu,["deb"]],[exports.ChonkyIconName.windows,["exe"]],[exports.ChonkyIconName.rust,["rs","rlib"]],[exports.ChonkyIconName.python,["py","ipynb"]],[exports.ChonkyIconName.nodejs,["js","jsx","ts","tsx","d.ts"]],[exports.ChonkyIconName.php,["php"]],[exports.ChonkyIconName.git,[".gitignore"]],[exports.ChonkyIconName.adobe,["psd"]],[exports.ChonkyIconName.pdf,["pdf"]],[exports.ChonkyIconName.excel,["xls","xlsx"]],[exports.ChonkyIconName.word,["doc","docx","odt"]],[exports.ChonkyIconName.flash,["swf"]]],n=new h({ignoreCase:!0}),r=0,o=t;r<o.length;r++)for(var i=o[r],a=i[0],l=i[1],c=0;c<l.length;++c)n.put(l[c],{icon:a,colorCode:(e+=5)%(kt.length-1)+1},!0);return n}(),Dt={colors:{debugRed:"#fabdbd",debugBlue:"#bdd8fa",debugGreen:"#d2fabd",debugPurple:"#d2bdfa",debugYellow:"#fae9bd",textActive:"#09f"},fontSizes:{rootPrimary:15},margins:{rootLayoutMargin:8},toolbar:{size:30,lineHeight:"30px",fontSize:15,buttonRadius:4},dnd:{canDropColor:"green",cannotDropColor:"red",canDropMask:"rgba(180, 235, 180, 0.75)",cannotDropMask:"rgba(235, 180, 180, 0.75)",fileListCanDropMaskOne:"rgba(180, 235, 180, 0.1)",fileListCanDropMaskTwo:"rgba(180, 235, 180, 0.2)",fileListCannotDropMaskOne:"rgba(235, 180, 180, 0.1)",fileListCannotDropMaskTwo:"rgba(235, 180, 180, 0.2)"},dragLayer:{border:"solid 2px #09f",padding:"7px 10px",borderRadius:2},fileList:{desktopGridGutter:8,mobileGridGutter:5},gridFileEntry:{childrenCountSize:"1.6em",iconColorFocused:"#000",iconSize:"2.4em",iconColor:"#fff",borderRadius:5,fontSize:14,fileColorTint:"rgba(255, 255, 255, 0.4)",folderBackColorTint:"rgba(255, 255, 255, 0.1)",folderFrontColorTint:"rgba(255, 255, 255, 0.4)"},listFileEntry:{propertyFontSize:14,iconFontSize:"1.1em",iconBorderRadius:5,fontSize:14}},Mt={gridFileEntry:{fileColorTint:"rgba(50, 50, 50, 0.4)",folderBackColorTint:"rgba(50, 50, 50, 0.4)",folderFrontColorTint:"rgba(50, 50, 50, 0.15)"}},Nt={fontSizes:{rootPrimary:13},margins:{rootLayoutMargin:4},toolbar:{size:28,lineHeight:"28px",fontSize:13},gridFileEntry:{fontSize:13},listFileEntry:{propertyFontSize:12,iconFontSize:"1em",fontSize:13}},At=function(){return b("(max-width:480px)")},Ot=function(e,t){return"repeating-linear-gradient(45deg,"+e+","+e+" 10px,"+t+" 0,"+t+" 20px)"},zt=function(e){return c.createUseStyles(e)},Tt=function(e){var t={},n=c.createUseStyles((function(n){var r=e(n),o={};return Object.keys(r).map((function(e){var n="chonky-"+e;o["@global ."+n]=r[e],t[e]=n})),o}));return function(){var e=n.apply(void 0,arguments),r={};return Object.keys(t).map((function(e){r[e]=t[e]})),T({},r,e)}},Lt=function(e){return[e,"!important"]},Rt=y,_t=o.memo(o.forwardRef((function(e,t){var n;return ft(ct.setRawFiles,null!=(n=e.files)?n:at.rawFiles),ft(ct.setRawFolderChain,e.folderChain),ut(Ve,Je(e.fileActions,mt.fileActions),Je(e.disableDefaultFileActions,mt.disableDefaultFileActions)),ut(ct.setExternalFileActionHandler,Je(e.onFileAction,mt.onFileAction)),ut(ct.setSelectionDisabled,Je(e.disableSelection,mt.disableSelection,"boolean")),ut(Ge,Je(e.defaultSortActionId,mt.defaultSortActionId)),ut(We,Je(e.defaultFileViewActionId,mt.defaultFileViewActionId,"string")),ut(ct.setThumbnailGenerator,Je(e.thumbnailGenerator,mt.thumbnailGenerator)),ut(ct.setDoubleClickDelay,Je(e.doubleClickDelay,mt.doubleClickDelay,"number")),ut(ct.setDisableDragAndDrop,Je(e.disableDragAndDrop,mt.disableDragAndDrop,"boolean")),ut(ct.setClearSelectionOnOutsideClick,Je(e.clearSelectionOnOutsideClick,mt.clearSelectionOnOutsideClick,"boolean")),function(e){var t=s.useStore(),n=s.useDispatch();r.useImperativeHandle(e,(function(){return{getFileSelection:function(){var e=ce(t.getState());return new Set(Object.keys(e))},setFileSelection:function(e,t){void 0===t&&(t=!0);var r=Array.from(e);n(ct.selectFiles({fileIds:r,reset:t}))},requestFileAction:function(e,t){return Promise.resolve(n(Ye(e,t))).then()}}}),[t,n])}(t),null})));_t.displayName="ChonkyBusinessLogicInner";var jt=o.memo(_t);jt.displayName="ChonkyBusinessLogic";var Bt=function(){return!!r.useContext(i.DndContext).dragDropManager},Ht={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},Pt=function(e,t,n){if(!e||!t||!n)return{display:"none"};var r="translate("+(e.x+(n.x-t.x))+"px, "+(e.y+(n.y-t.y))+"px)";return{transform:r,WebkitTransform:r}},Kt=function(){var e=Vt(),t=i.useDragLayer((function(e){return{item:e.getItem(),itemType:e.getItemType(),initialCursorOffset:e.getInitialClientOffset(),initialFileOffset:e.getInitialSourceClientOffset(),currentFileOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}})),n=t.item;if(!t.isDragging||"dnd-chonky-file-entry"!==t.itemType||!n.payload)return null;var r=n.payload.selectedFiles.length;return o.createElement("div",{style:Ht},o.createElement("div",{style:Pt(t.initialCursorOffset,t.initialFileOffset,t.currentFileOffset)},o.createElement("div",{className:e.fileDragPreview},o.createElement("b",null,n.payload.draggedFile.name),r>1&&o.createElement(o.Fragment,null," and ",o.createElement("strong",null,r-1," other file",r-1!=1?"s":"")))))},Vt=Tt((function(e){return{fileDragPreview:{boxShadow:"2px 2px 5px "+e.palette.divider,backgroundColor:e.palette.background.default,borderRadius:e.dragLayer.borderRadius,fontSize:e.fontSizes.rootPrimary,color:e.palette.text.primary,padding:e.dragLayer.padding,border:e.dragLayer.border,display:"inline-block"}}})),qt=o.memo((function(e){var t=e.fileActionId,n=s.useDispatch(),o=dt(Z,t);return r.useEffect((function(){if(o&&o.hotkeys&&0!==o.hotkeys.length){var e=o.hotkeys.join(","),t=function(e){e.preventDefault(),n(Ye(o,void 0))};return x(e,t),function(){return x.unbind(e,t)}}}),[n,o]),null})),Wt=function(e){var t=e.children,n=s.useDispatch(),i=s.useSelector(X),a=s.useSelector(Ce),l=s.useSelector(xe),c=r.useCallback((function(e){l&&!$e(e.target,(function(e){return e.tagName&&"button"===e.tagName.toLowerCase()}))&&n(ct.clearSelection())}),[n,l]),d=r.useMemo((function(){return i.map((function(e){return o.createElement(qt,{key:"file-action-listener-"+e,fileActionId:e})}))}),[i]),u=Bt(),f=function(){var e=s.useDispatch(),t=H(s.useSelector(Se));return r.useCallback((function(n){if(t.current&&!n.altKey){n.preventDefault();var r,o=(r=$e(n.target,(function(e){return e.tagName&&"div"===e.tagName.toLowerCase()&&e.dataset&&e.dataset.chonkyFileId})))?r.dataset.chonkyFileId:null;e(Ye(rt.OpenFileContextMenu,{clientX:n.clientX,clientY:n.clientY,triggerFileId:o}))}}),[t,e])}(),p=Gt();return o.createElement(C,{onClickAway:c},o.createElement(v,{className:p.chonkyRoot,onContextMenu:f},!a&&u&&o.createElement(Kt,null),d,t||null))},Gt=Tt((function(e){return{chonkyRoot:{backgroundColor:e.palette.background.paper,border:"solid 1px "+e.palette.divider,padding:e.margins.rootLayoutMargin,fontSize:e.fontSizes.rootPrimary,color:e.palette.text.primary,touchAction:"manipulation",fontFamily:"sans-serif",flexDirection:"column",boxSizing:"border-box",textAlign:"left",borderRadius:4,display:"flex",height:"100%",webkitTouchCallout:"none",webkitUserSelect:"none",mozUserSelect:"none",msUserSelect:"none",userSelect:"none"}}})),Ut=o.forwardRef((function(e,f){var p,g=e.instanceId,h=e.iconComponent,b=e.children,y=Je(e.disableDragAndDrop,mt.disableDragAndDrop,"boolean"),v=Je(e.disableDragAndDropProvider,mt.disableDragAndDropProvider,"boolean"),C=Je(e.darkMode,mt.darkMode,"boolean"),x=Je(e.i18n,mt.i18n),S=r.useMemo((function(){return T({},vt,null==x?void 0:x.formatters)}),[x]),I=function(e){var t=B((function(){var t=T({},at,{instanceId:e});return u.configureStore({preloadedState:t,reducer:st,middleware:function(e){return e({serializableCheck:!1})},devTools:{name:"chonky_"+e}})}));return function(e){r.useEffect((function(){var t=m((function(){return ce(e.getState())})),n=[e.subscribe(t((function(t,n){if(t!==n){var r=se(e.getState()),o=new Set(r);e.dispatch(Ye(rt.ChangeSelection,{selection:o}))}})))];return function(){for(var e,t=R(n);!(e=t()).done;)(0,e.value)()}}),[e])}(t),t}(B((function(){return null!=g?g:d.generate()}))),F=At(),k=r.useMemo((function(){var r=t.createMuiTheme({palette:{type:C?"dark":"light"}}),o=n(Dt,C?Mt:{}),i=n(r,n(o,e.customTheme?e.customTheme:{}));return F?n(i,Nt):i}),[C,F]),w=o.createElement(o.Fragment,null,o.createElement(jt,Object.assign({ref:f},e)),o.createElement(Wt,null,b));return o.createElement(l.IntlProvider,Object.assign({locale:"en",defaultLocale:"en"},x),o.createElement(Ct.Provider,{value:S},o.createElement(s.Provider,{store:I},o.createElement(c.ThemeProvider,{theme:k},o.createElement(t.ThemeProvider,{theme:k},o.createElement(xt.Provider,{value:null!=(p=null!=h?h:mt.iconComponent)?p:pt},y||v?w:o.createElement(i.DndProvider,{backend:a.HTML5Backend},w)))))))}));Ut.displayName="FileBrowser";var Yt,Xt=function(e){var t=e.file,n=e.forceDisableDrop,o=e.includeChildrenDrops,a=H(s.useSelector(J)),l=function(){var e=Bt(),t=r.useCallback((function(){return[{},function(){return null}]}),[]),n=e?i.useDrop:t;return n.apply(void 0,arguments)}({accept:"dnd-chonky-file-entry",drop:r.useCallback((function(e,n){if(n.canDrop())return{dropTarget:t}}),[t]),canDrop:r.useCallback((function(e,r){if(n||!K.isDroppable(t)||!r.isOver({shallow:!0})&&!o)return!1;var i=e.payload,l=i.source,c=i.draggedFile,s=i.selectedFiles,d=new Set;d.add(t.id),a.current.map((function(e){e&&d.add(e.id)}));for(var u,f=R([c].concat(s));!(u=f()).done;)if(d.has(u.value.id))return!1;return t.id!==(null==l?void 0:l.id)}),[n,t,o,a]),collect:r.useCallback((function(e){return{isOver:e.isOver(),isOverCurrent:e.isOver({shallow:!0}),canDrop:e.canDrop()}}),[])}),c=l[0];return{dndIsOver:c.isOver,dndIsOverCurrent:c.isOverCurrent,dndCanDrop:c.canDrop,drop:l[1]}},Zt=function(e,t){var n=s.useDispatch(),o=H(s.useSelector(ee));r.useEffect((function(){var r,i=null;return t.dndIsOver&&K.isDndOpenable(e)&&e.id!==(null==(r=o.current)?void 0:r.id)&&(i=setTimeout((function(){return n(Ye(et.OpenFiles,{targetFile:e,files:[e]}))}),1500)),function(){i&&clearTimeout(i)}}),[n,e,t.dndIsOver,o])},Qt=o.memo((function(e){var t,n,r=(n=e.maxLength,(t=e.minLength)+Math.floor(Math.random()*Math.floor(n-t))),i="&nbsp;".repeat(r),a=$t();return o.createElement("span",{className:a.textPlaceholder,dangerouslySetInnerHTML:{__html:i}})})),$t=zt((function(){return{"@keyframes loading-placeholder":{"0%":{opacity:.2},"50%":{opacity:.4},"100%":{opacity:.2}},textPlaceholder:{animationName:"$loading-placeholder",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDuration:"1.5s",backgroundColor:"#ccc",whiteSpace:"nowrap",overflow:"hidden",borderRadius:4,maxWidth:"40%",minWidth:20}}})),Jt=function(e){return r.useMemo((function(){return T({role:"listitem"},{"data-test-id":"file-entry","data-chonky-file-id":e?e.id:void 0})}),[e])},en=function(e,t,n){var o=function(e){return r.useMemo((function(){return e?!0===e.isDir?{icon:exports.ChonkyIconName.folder,colorCode:0}:Et.getWithCheckpoints(e.name,".",!0)||{icon:exports.ChonkyIconName.file,colorCode:32}:{icon:exports.ChonkyIconName.loading,colorCode:0}}),[e])}(e),i=nn(e),a=i.thumbnailUrl,l=i.thumbnailLoading;return r.useMemo((function(){var r=a?wt[o.colorCode]:kt[o.colorCode],i=l||!e,c=l?exports.ChonkyIconName.loading:o.icon;return{childrenCount:K.getChildrenCount(e),icon:e&&void 0!==e.icon?e.icon:c,iconSpin:i,thumbnailUrl:a,color:e&&void 0!==e.color?e.color:r,selected:t,focused:!!n}}),[e,n,o,t,l,a])},tn=function(e){var t=null;return e.dndIsOver?t=e.dndCanDrop?exports.ChonkyIconName.dndCanDrop:exports.ChonkyIconName.dndCannotDrop:e.dndIsDragging&&(t=exports.ChonkyIconName.dndDragging),t},nn=function(e){var t=s.useSelector(ye),n=r.useState(null),o=n[0],i=n[1],a=r.useState(!1),l=a[0],c=a[1],d=r.useRef(0);return r.useEffect((function(){var n=!1;return e&&(t?(0===d.current&&c(!0),d.current++,Promise.resolve().then((function(){return t(e)})).then((function(e){n||(c(!1),e&&"string"==typeof e&&i(e))})).catch((function(e){n||c(!1),P.error('User-defined "thumbnailGenerator" handler threw an error: '+e.message)}))):e.thumbnailUrl&&i(e.thumbnailUrl)),function(){n=!0}}),[e,i,c,t]),{thumbnailUrl:o,thumbnailLoading:l}};(Yt=exports.CustomVisibilityState||(exports.CustomVisibilityState={}))[Yt.Hidden=0]="Hidden",Yt[Yt.Disabled=1]="Disabled",Yt[Yt.Default=2]="Default",Yt[Yt.Active=3]="Active";var rn=function(e){var t=s.useDispatch(),n=dt(Z,e);return r.useCallback((function(){return t(Ye(n,void 0))}),[t,n])},on=function(e){var t,n=s.useSelector(te),o=s.useSelector(me),i=s.useSelector(ge),a=s.useSelector(he),l=dt(Z,e),c=dt(be,null==l||null==(t=l.option)?void 0:t.id),d=0===dt(pe,e);return r.useMemo((function(){var e,t;if(!l)return{icon:null,active:!1,disabled:!0};var r=null!=(e=null==(t=l.button)?void 0:t.icon)?e:null;l.sortKeySelector?r=i===l.id?a===_.ASC?exports.ChonkyIconName.sortAsc:exports.ChonkyIconName.sortDesc:exports.ChonkyIconName.placeholder:l.option&&(r=c?exports.ChonkyIconName.toggleOn:exports.ChonkyIconName.toggleOff);var s=l.id===i,u=l.fileViewConfig===o,f=!!l.option&&!!c,p=!1,m=!1;void 0!==l.customVisibility&&(p=l.customVisibility()===exports.CustomVisibilityState.Disabled,m=l.customVisibility()===exports.CustomVisibilityState.Active);var g=s||u||f||m,h=!!l.requiresSelection&&d||p;return l.id===rt.OpenParentFolder.id&&(h=h||!K.isOpenable(n)),{icon:r,active:g,disabled:h}}),[n,o,i,a,l,c,d])},an=o.memo((function(e){var t,n=e.className,i=e.text,a=e.tooltip,l=e.active,c=e.icon,s=e.iconOnly,d=e.onClick,u=e.disabled,f=e.dropdown,p=ln(),m=r.useContext(xt),g=c||s?o.createElement("div",{className:s?"":p.iconWithText},o.createElement(m,{icon:c||exports.ChonkyIconName.fallbackIcon,fixedWidth:!0})):null,h=Rt(((t={})[null!=n?n:""]=!0,t[p.baseButton]=!0,t[p.iconOnlyButton]=s,t[p.activeButton]=!!l,t));return o.createElement(I,{className:h,onClick:d,title:a||i,disabled:u||!d},g,i&&!s&&o.createElement("span",null,i),f&&o.createElement("div",{className:p.iconDropdown},o.createElement(m,{icon:c||exports.ChonkyIconName.dropdown,fixedWidth:!0})))})),ln=Tt((function(e){return{baseButton:{fontSize:Lt(e.toolbar.fontSize),textTransform:Lt("none"),letterSpacing:Lt(0),minWidth:Lt("auto"),lineHeight:e.toolbar.lineHeight,height:e.toolbar.size,paddingBottom:Lt(0),paddingTop:Lt(0)},iconWithText:{marginRight:8},iconOnlyButton:{width:e.toolbar.size,textAlign:"center"},iconDropdown:{fontSize:"0.7em",marginLeft:2,marginTop:1},activeButton:{color:Lt(e.colors.textActive)}}})),cn=o.memo((function(e){var t=e.fileActionId,n=dt(Z,t),r=rn(t),i=on(t),a=i.icon,l=i.active,c=i.disabled,s=bt(n),d=s.buttonName,u=s.buttonTooltip;if(!n)return null;var f=n.button;return f?void 0!==n.customVisibility&&n.customVisibility()===exports.CustomVisibilityState.Hidden?null:o.createElement(an,{text:d,tooltip:u,icon:a,iconOnly:f.iconOnly,active:l,onClick:r,disabled:c}):null})),sn=o.memo((function(e){var t,n=e.first,i=e.current,a=e.item,l=a.file,c=a.disabled,s=a.onClick,d=Xt({file:l,forceDisableDrop:!l||i}),u=d.dndIsOver,f=d.dndCanDrop,p=d.drop,m=r.useMemo((function(){return{dndIsOver:u,dndCanDrop:f,dndIsDragging:!1}}),[f,u]);Zt(l,m);var g=tn(m),h=r.useContext(xt),b=dn(m),y=Rt(((t={})[b.baseBreadcrumb]=!0,t[b.disabledBreadcrumb]=c,t[b.currentBreadcrumb]=i,t)),v=l?l.name:"Loading...",C=n&&void 0===(null==l?void 0:l.folderChainIcon)?exports.ChonkyIconName.folder:null==l?void 0:l.folderChainIcon;return o.createElement("div",{className:b.buttonContainer,ref:l?p:null},l&&g&&o.createElement("div",{className:b.dndIndicator},o.createElement(h,{icon:g,fixedWidth:!0})),o.createElement(an,{icon:C,className:y,text:v,disabled:c,onClick:s}))})),dn=zt((function(e){return{buttonContainer:{position:"relative"},baseBreadcrumb:{color:function(t){var n=e.palette.text.primary;return t.dndIsOver&&(n=t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor),Lt(n)}},disabledBreadcrumb:{color:function(){return Lt(e.palette.text.disabled)}},currentBreadcrumb:{textDecoration:Lt("underline")},dndIndicator:{color:function(t){return t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor},backgroundColor:function(t){return t.dndCanDrop?e.dnd.canDropMask:e.dnd.cannotDropMask},lineHeight:"calc("+e.toolbar.lineHeight+" - 6px)",transform:"translateX(-50%) translateY(-50%)",borderRadius:e.toolbar.buttonRadius,height:e.toolbar.size-6,width:e.toolbar.size-6,boxSizing:"border-box",position:"absolute",textAlign:"center",left:"50%",top:"50%",zIndex:5}}})),un=o.memo((function(){var e,t,n=fn(),i=(e=s.useSelector(J),t=s.useDispatch(),r.useMemo((function(){var n=[];if(!e)return n;for(var r=function(r){var o=e[r];n.push({file:o,disabled:!o,onClick:K.isOpenable(o)&&r!==e.length-1?function(){return t(Ye(rt.OpenFiles,{targetFile:o,files:[o]}))}:void 0})},o=0;o<e.length;++o)r(o);return n}),[t,e])),a=r.useMemo((function(){for(var e=[],t=0;t<i.length;++t){var n=o.createElement(sn,{key:"folder-chain-"+t,first:0===t,current:t===i.length-1,item:i[t]});e.push(n)}return e}),[i]);return o.createElement(v,{className:n.navbarWrapper},o.createElement(v,{className:n.navbarContainer},o.createElement(cn,{fileActionId:rt.OpenParentFolder.id}),o.createElement(S,{className:n.navbarBreadcrumbs,classes:{separator:n.separator}},a)))})),fn=Tt((function(e){return{navbarWrapper:{paddingBottom:e.margins.rootLayoutMargin},navbarContainer:{display:"flex"},upDirectoryButton:{fontSize:Lt(e.toolbar.fontSize),height:e.toolbar.size,width:e.toolbar.size,padding:"0px !important"},navbarBreadcrumbs:{fontSize:Lt(e.toolbar.fontSize),flexGrow:100},separator:{marginRight:Lt(4),marginLeft:Lt(4)}}})),pn=o.forwardRef((function(e,t){var n,i=e.text,a=e.active,l=e.icon,c=e.onClick,s=e.disabled,d=mn(),u=r.useContext(xt),f=Rt(((n={})[d.baseButton]=!0,n[d.activeButton]=a,n));return o.createElement(E,{ref:t,className:f,onClick:c,disabled:s},l&&o.createElement(k,{className:d.icon},o.createElement(u,{icon:l,fixedWidth:!0})),o.createElement(w,{primaryTypographyProps:{className:d.text}},i))})),mn=Tt((function(e){return{baseButton:{lineHeight:Lt(e.toolbar.lineHeight),height:Lt(e.toolbar.size),minHeight:Lt("auto"),minWidth:Lt("auto"),padding:Lt(20)},icon:{fontSize:Lt(e.toolbar.fontSize),minWidth:Lt("auto"),color:Lt("inherit"),marginRight:8},text:{fontSize:Lt(e.toolbar.fontSize)},activeButton:{color:Lt(e.colors.textActive)}}})),gn=o.forwardRef((function(e,t){var n=e.fileActionId,i=e.onClickFollowUp,a=dt(Z,n),l=rn(n),c=on(n),s=c.icon,d=c.active,u=c.disabled,f=bt(a).buttonName,p=r.useCallback((function(){l(),i&&i()}),[i,l]);return a&&a.button?void 0!==a.customVisibility&&a.customVisibility()===exports.CustomVisibilityState.Hidden?null:o.createElement(pn,{ref:t,text:f,icon:s,onClick:p,active:d,disabled:u}):null})),hn=o.memo((function(e){var t,n,i=e.name,a=e.fileActionIds,c=o.useState(null),s=c[0],d=c[1],u=r.useCallback((function(e){return d(e.currentTarget)}),[d]),f=r.useCallback((function(){return d(null)}),[d]),p=r.useMemo((function(){return a.map((function(e){return o.createElement(gn,{key:"menu-item-"+e,fileActionId:e,onClickFollowUp:f})}))}),[a,f]),m=(t=i,n=l.useIntl(),r.useMemo((function(){return n.formatMessage({id:gt(exports.I18nNamespace.FileActionGroups,t),defaultMessage:t})}),[t,n])),g=bn();return o.createElement(o.Fragment,null,o.createElement(an,{text:m,onClick:u,dropdown:!0}),o.createElement(F,{autoFocus:!0,keepMounted:!0,elevation:2,anchorEl:s,onClose:f,open:Boolean(s),transitionDuration:150,classes:{list:g.dropdownList}},p))})),bn=Tt((function(){return{dropdownList:{paddingBottom:Lt(0),paddingTop:Lt(0)}}})),yn=o.memo((function(){var e=vn(),t=s.useSelector(He.getDisplayFileIds),n=s.useSelector(de),r=s.useSelector(ae),i=l.useIntl(),a=i.formatMessage({id:gt(exports.I18nNamespace.Toolbar,"visibleFileCount"),defaultMessage:"{fileCount, plural,\n                =0 {# items}\n                one {# item}\n                other {# items}\n            }"},{fileCount:t.length}),c=i.formatMessage({id:gt(exports.I18nNamespace.Toolbar,"selectedFileCount"),defaultMessage:"{fileCount, plural,\n                =0 {}\n                other {# selected}\n            }"},{fileCount:n}),d=i.formatMessage({id:gt(exports.I18nNamespace.Toolbar,"hiddenFileCount"),defaultMessage:"{fileCount, plural,\n                =0 {}\n                other {# hidden}\n            }"},{fileCount:r});return o.createElement("div",{className:e.infoContainer},o.createElement(D,{className:e.infoText,variant:"body1"},a,(c||d)&&o.createElement("span",{className:e.extraInfoSpan},"(",o.createElement("span",{className:e.selectionSizeText},c),c&&d&&", ",o.createElement("span",{className:e.hiddenCountText},d),")")))})),vn=Tt((function(e){return{infoContainer:{height:e.toolbar.size,display:"flex"},infoText:{lineHeight:Lt(e.toolbar.lineHeight),fontSize:Lt(e.toolbar.fontSize),marginLeft:Lt(12),height:e.toolbar.size},extraInfoSpan:{marginRight:Lt(8),marginLeft:Lt(8),opacity:.8},selectionSizeText:{color:e.colors.textActive},hiddenCountText:{}}})),Cn=o.memo((function(){var e=l.useIntl().formatMessage({id:gt(exports.I18nNamespace.Toolbar,"searchPlaceholder"),defaultMessage:"Search"}),t=xn(),n=r.useContext(xt),i=r.useRef(),a=s.useDispatch(),c=s.useSelector(le),d=r.useState(c),u=d[0],f=d[1],p=function(e,t){var n=r.useState(e),o=n[0],i=n[1];return r.useEffect((function(){var t=setTimeout((function(){i(e)}),300);return function(){clearTimeout(t)}}),[e,300]),[o,i]}(u)[0],m=r.useState(!1),g=m[0],h=m[1];r.useEffect((function(){return a(ct.setFocusSearchInput((function(){i.current&&i.current.focus()}))),function(){a(ct.setFocusSearchInput(null))}}),[a]),r.useEffect((function(){h(!1),a(ct.setSearchString(p))}),[p,a]);var b=r.useCallback((function(e){h(!0),f(e.currentTarget.value)}),[]),y=r.useCallback((function(e){"Escape"===e.key&&(f(""),a(ct.setSearchString("")),i.current&&i.current.blur())}),[a]);return o.createElement(N,{className:t.searchFieldContainer,size:"small",variant:"outlined",value:u,placeholder:e,onChange:b,inputRef:i,InputProps:{onKeyUp:y,startAdornment:o.createElement(M,{className:t.searchIcon,position:"start"},o.createElement(n,{icon:g?exports.ChonkyIconName.loading:exports.ChonkyIconName.search,spin:g})),className:t.searchFieldInput},inputProps:{className:t.searchFieldInputInner}})})),xn=Tt((function(e){return{searchFieldContainer:{height:e.toolbar.size,width:150},searchIcon:{fontSize:"0.9em",opacity:.75},searchFieldInput:{lineHeight:Lt(0),padding:Lt(0),margin:Lt(0),fontSize:Lt(e.toolbar.fontSize),borderRadius:e.toolbar.buttonRadius,height:e.toolbar.size-4,paddingLeft:Lt(8),marginTop:2},searchFieldInputInner:{lineHeight:Lt(e.toolbar.size-4+"px"),fontSize:Lt(e.toolbar.fontSize),height:Lt(e.toolbar.size-4),padding:Lt([0,8,0,0]),margin:Lt(0),"-webkit-appearance":"none"}}})),Sn=o.memo((function(){var e=In(),t=s.useSelector(Q),n=r.useMemo((function(){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="toolbar-item-"+("string"==typeof r?r:r.name),a="string"==typeof r?o.createElement(cn,{key:i,fileActionId:r}):o.createElement(hn,{key:i,name:r.name,fileActionIds:r.fileActionIds});e.push(a)}return e}),[t]);return o.createElement("div",{className:e.toolbarWrapper},o.createElement("div",{className:e.toolbarContainer},o.createElement("div",{className:e.toolbarLeft},o.createElement(Cn,null),o.createElement(yn,null)),o.createElement("div",{className:e.toolbarRight},n)))})),In=Tt((function(e){return{toolbarWrapper:{},toolbarContainer:{flexWrap:"wrap-reverse",display:"flex"},toolbarLeft:{paddingBottom:e.margins.rootLayoutMargin,flexWrap:"nowrap",flexGrow:1e4,display:"flex"},toolbarLeftFiller:{flexGrow:1e4},toolbarRight:{paddingBottom:e.margins.rootLayoutMargin,flexWrap:"nowrap",display:"flex"}}})),Fn=function(e){var t=e.width,n=e.height,i=kn(),a=r.useContext(xt),c={width:t,height:n},s=l.useIntl().formatMessage({id:gt(exports.I18nNamespace.FileList,"nothingToShow"),defaultMessage:"Nothing to show"});return o.createElement("div",{className:i.fileListEmpty,style:c},o.createElement("div",{className:i.fileListEmptyContent},o.createElement(a,{icon:exports.ChonkyIconName.folderOpen}),"  ",s))},kn=Tt((function(e){return{fileListEmpty:{color:e.palette.text.disabled,position:"relative",textAlign:"center",fontSize:"1.2em"},fileListEmptyContent:{transform:"translateX(-50%) translateY(-50%)",position:"absolute",left:"50%",top:"50%"}}})),wn=function(e){var t=e.children,n=e.wrapperTag,i=e.passthroughProps,a=e.onSingleClick,l=e.onDoubleClick,c=e.onKeyboardClick,d=e.setFocused,u=function(e,t){var n=s.useSelector(ve),o=r.useRef({clickCount:0,clickTimeout:null});return r.useCallback((function(r){var i={altKey:r.altKey,ctrlKey:r.ctrlKey||r.metaKey,shiftKey:r.shiftKey};o.current.clickCount++,1===o.current.clickCount?(e&&(r.preventDefault(),e(i)),o.current.clickCount=1,o.current.clickTimeout=setTimeout((function(){return o.current.clickCount=0}),n)):2===o.current.clickCount&&(t&&(r.preventDefault(),t(i)),"number"==typeof o.current.clickTimeout&&(clearTimeout(o.current.clickTimeout),o.current.clickTimeout=null,o.current.clickCount=0))}),[n,e,t,o])}(a,l),f=function(e){return r.useCallback((function(t){if(e){var n={enterKey:"Enter"===t.nativeEvent.code,spaceKey:"Space"===t.nativeEvent.code,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey};(n.spaceKey||n.enterKey)&&(t.preventDefault(),t.stopPropagation(),e(n))}}),[e])}(c),p={onFocus:r.useCallback((function(){return d&&d(!0)}),[d]),onBlur:r.useCallback((function(){return d&&d(!1)}),[d])};(a||l||c)&&(p.onClick=u,p.onKeyDown=f,p.tabIndex=0);var m=T({},p,i);return o.createElement(n,Object.assign({},m),t)},En=o.memo((function(e){var t=e.file,n=e.className,i=function(e){var t=r.useMemo((function(){var t=[];return K.isHidden(e)&&t.push(exports.ChonkyIconName.hidden),K.isSymlink(e)&&t.push(exports.ChonkyIconName.symlink),K.isEncrypted(e)&&t.push(exports.ChonkyIconName.lock),t}),[e]),n=r.useContext(xt);return r.useMemo((function(){return t.map((function(e,t){return o.createElement(n,{key:"file-modifier-"+t,icon:e})}))}),[n,t])}(t),a=function(e){return r.useMemo((function(){if(!e)return o.createElement(Qt,{minLength:15,maxLength:20});var t,n,r,i=null;return K.isDirectory(e)?t=e.name:(i=null!=(n=e.ext)?n:(r=e.name.split(".")).length?"."+r[r.length-1]:"",t=e.name.substr(0,e.name.length-i.length)),o.createElement(o.Fragment,null,t,i&&o.createElement("span",{className:"chonky-file-entry-description-title-extension"},i))}),[e])}(t),l=Dn();return o.createElement("span",{className:n,title:t?t.name:void 0},i.length>0&&o.createElement("span",{className:l.modifierIcons},i),a)}));En.displayName="FileEntryName";var Dn=zt((function(e){return{modifierIcons:{color:e.palette.text.hint,position:"relative",fontSize:"0.775em",paddingRight:5}}})),Mn=o.memo((function(e){var t=e.file,n=en(t,e.selected,e.focused),i=yt(t),a=i.fileModDateString,l=i.fileSizeString,c=Nn(n),s=r.useContext(xt),d=Jt(t);return o.createElement("div",Object.assign({className:c.listFileEntry},d),o.createElement("div",{className:c.listFileEntryIcon},o.createElement(s,{icon:n.icon,spin:n.iconSpin,fixedWidth:!0})),o.createElement("div",{className:c.listFileEntryDescription},o.createElement("div",{className:c.listFileEntryName,title:t?t.name:void 0},o.createElement(En,{file:t})),o.createElement("div",{className:c.listFileEntryProperties},o.createElement("div",{className:c.listFileEntryProperty},t?null!=a?a:o.createElement("span",null,"—"):o.createElement(Qt,{minLength:5,maxLength:15})),o.createElement("div",{className:c.listFileEntryProperty},t?null!=l?l:o.createElement("span",null,"—"):o.createElement(Qt,{minLength:10,maxLength:20})))),o.createElement("div",{className:"chonky-file-entry-outline"}),o.createElement("div",{className:"chonky-file-entry-selection"}))})),Nn=zt((function(e){return{listFileEntry:{fontSize:e.listFileEntry.fontSize,alignItems:"center",position:"relative",display:"flex",height:"100%"},listFileEntryIcon:{backgroundColor:function(e){return e.color},boxShadow:"inset rgba(255, 255, 255, 0.5) 0 0 0 999px",borderRadius:e.listFileEntry.iconBorderRadius,fontSize:e.listFileEntry.iconFontSize,color:"#fff",padding:8},listFileEntryDescription:{flexDirection:"column",display:"flex",flexGrow:1},listFileEntryName:{padding:[0,8,4,8]},listFileEntryProperties:{fontSize:e.listFileEntry.propertyFontSize,flexDirection:"row",display:"flex"},listFileEntryProperty:{padding:[0,8],opacity:.4}}})),An=o.memo((function(e){var t=e.file,n=e.children,l=function(e){var t=function(e){var t=s.useStore(),n=H(e),o=r.useCallback((function(){var e=t.getState();return{sourceInstanceId:U(e),source:ee(e),draggedFile:n.current,selectedFiles:fe(e)}}),[t,n]),l=s.useDispatch(),c=r.useCallback((function(){return K.isDraggable(n.current)}),[n]),d=r.useCallback((function(){var e={type:"dnd-chonky-file-entry",payload:o()};return l(Ye(rt.StartDragNDrop,e.payload)),e}),[l,o]),u=r.useCallback((function(e,t){var n=t.getDropResult();K.isDraggable(e.payload.draggedFile)&&n&&n.dropTarget&&l(Ye(rt.EndDragNDrop,T({},e.payload,{destination:n.dropTarget,copy:"copy"===n.dropEffect})))}),[l]),f=function(){var e=Bt(),t=r.useCallback((function(){return[{},function(){return null},function(){return null}]}),[]),n=e?i.useDrag:t;return n.apply(void 0,arguments)}({item:r.useMemo((function(){return{type:"dnd-chonky-file-entry",payload:{}}}),[]),canDrag:c,begin:d,end:u,collect:r.useCallback((function(e){return{isDragging:e.isDragging()}}),[])}),p=f[0].isDragging,m=f[1],g=f[2];return r.useEffect((function(){g(a.getEmptyImage(),{captureDraggingState:!0})}),[g]),{dndIsDragging:p,drag:m}}(e),n=t.dndIsDragging,o=t.drag,l=Xt({file:e}),c=l.dndIsOver,d=l.dndCanDrop;return{drop:l.drop,drag:o,dndState:r.useMemo((function(){return{dndIsDragging:n,dndIsOver:c,dndCanDrop:d}}),[d,n,c])}}(t),c=l.drop,d=l.drag,u=l.dndState;Zt(t,u);var f=On();return o.createElement("div",{ref:c,className:f.fillParent},o.createElement("div",{ref:K.isDraggable(t)?d:null,className:f.fillParent},n(u)))})),On=zt((function(){return{fillParent:{height:"100%"}}})),zn=o.memo((function(e){var t=e.className,n=e.thumbnailUrl,r=n?{backgroundImage:"url('"+n+"')"}:{},i=Tn();return o.createElement("div",{className:y([t,i.fileThumbnail]),style:r})}));zn.displayName="FileThumbnail";var Tn=Tt((function(){return{fileThumbnail:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain"}}})),Ln=o.memo((function(e){var t,n=e.className,i=e.dndState,a=tn(i),l=Rn(i),c=r.useContext(xt);if(!a)return null;var s=Rt(((t={})[l.dndIndicator]=!0,t[n]=!0,t));return o.createElement("div",{className:s},o.createElement(c,{icon:a}))})),Rn=zt((function(e){return{dndIndicator:{color:function(t){return t.dndIsOver?t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:"#000"},boxSizing:"border-box",position:"absolute",fontSize:"1.2em",opacity:.6,padding:6,"&:before":{borderBottom:"50px solid transparent",borderLeft:"50px solid #fff",position:"absolute",content:'""',zIndex:-1,left:0,top:0}}}})),_n=o.memo((function(e){var t,n=e.className,r=e.entryState,i=e.dndState,a=jn(r),l=Hn(r),c=Pn(r),s=Rt(((t={})[a.previewFile]=!0,t[n||""]=!!n,t));return o.createElement("div",{className:s},o.createElement("div",{className:a.folderBackSideMid},o.createElement("div",{className:a.folderBackSideTop}),o.createElement("div",{className:a.folderFrontSide},o.createElement(Ln,{className:l.dndIndicator,dndState:i}),o.createElement("div",{className:Rt([l.fileIcon,a.fileIcon])},r.childrenCount),o.createElement("div",{className:c.selectionIndicator}),o.createElement(zn,{className:l.thumbnail,thumbnailUrl:r.thumbnailUrl}))))}));_n.displayName="GridEntryPreviewFolder";var jn=zt((function(e){return{previewFile:{borderRadius:e.gridFileEntry.borderRadius,position:"relative",overflow:"hidden"},folderBackSideTop:{backgroundColor:function(e){return e.color},boxShadow:function(t){var n=e.gridFileEntry.folderBackColorTint;return t.focused?n="rgba(0, 0, 0, 0.3)":t.selected&&(n="rgba(0, 153, 255, .4)"),"inset "+n+" 0 0 0 999px"},borderTopLeftRadius:e.gridFileEntry.borderRadius,borderTopRightRadius:10,position:"absolute",right:"60%",height:13,top:-10,left:0,"&:after":{borderRightColor:e.palette.background.paper,borderTopColor:e.palette.background.paper,borderBottomColor:"transparent",borderLeftColor:"transparent",borderWidth:[0,15,10,0],borderStyle:"solid",position:"absolute",display:"block",content:'""',right:0,top:0}},folderBackSideMid:{backgroundColor:function(e){return e.color},boxShadow:function(t){var n=e.gridFileEntry.folderBackColorTint;return t.focused?n="rgba(0, 0, 0, 0.3)":t.selected&&(n="rgba(0, 153, 255, .4)"),"inset "+n+" 0 0 0 999px"},borderTopRightRadius:e.gridFileEntry.borderRadius,position:"absolute",bottom:0,right:0,left:0,top:10},folderFrontSide:{boxShadow:function(t){var n=[];return t.focused&&n.push("inset rgba(0, 0, 0, 1) 0 0 0 3px"),t.selected&&n.push("inset rgba(0, 153, 255, .65) 0 0 0 3px"),n.push("inset "+e.gridFileEntry.folderFrontColorTint+" 0 0 0 999px"),n.join(", ")},backgroundColor:function(e){return e.color},borderRadius:e.gridFileEntry.borderRadius,position:"absolute",overflow:"hidden",bottom:0,right:0,left:0,top:10},fileIcon:{fontSize:Lt(e.gridFileEntry.childrenCountSize)}}})),Bn=o.memo((function(e){var t,n=e.className,i=e.entryState,a=e.dndState,l=Hn(i),c=Pn(i),s=r.useContext(xt),d=Rt(((t={})[l.previewFile]=!0,t[n||""]=!!n,t));return o.createElement("div",{className:d},o.createElement(Ln,{className:l.dndIndicator,dndState:a}),o.createElement("div",{className:l.fileIcon},o.createElement(s,{icon:i.icon,spin:i.iconSpin})),o.createElement("div",{className:c.selectionIndicator}),o.createElement(zn,{className:l.thumbnail,thumbnailUrl:i.thumbnailUrl}))}));Bn.displayName="GridEntryPreviewFile";var Hn=zt((function(e){return{previewFile:{boxShadow:function(t){var n=[];return t.selected&&n.push("inset rgba(0,153,255, .65) 0 0 0 3px"),t.focused&&n.push("inset rgba(0, 0, 0, 1) 0 0 0 3px"),n.push("inset "+e.gridFileEntry.fileColorTint+" 0 0 0 999px"),n.join(", ")},backgroundColor:function(e){return e.color},borderRadius:e.gridFileEntry.borderRadius,position:"relative",overflow:"hidden"},dndIndicator:{zIndex:14},fileIcon:{transform:"translateX(-50%) translateY(-50%)",fontSize:e.gridFileEntry.iconSize,opacity:function(e){return e.thumbnailUrl&&!e.focused?0:1},color:function(t){return t.focused?e.gridFileEntry.iconColorFocused:e.gridFileEntry.iconColor},position:"absolute",left:"50%",zIndex:12,top:"50%"},thumbnail:{borderRadius:e.gridFileEntry.borderRadius,position:"absolute",zIndex:6,bottom:5,right:5,left:5,top:5}}})),Pn=zt((function(){return{selectionIndicator:{display:function(e){return e.selected?"block":"none"},background:"repeating-linear-gradient(45deg,rgba(0,153,255,.14),rgba(0,153,255,.14) 10px,rgba(0,153,255,.25) 0,rgba(0,153,255,.25) 20px)",backgroundColor:"rgba(0, 153, 255, .14)",position:"absolute",height:"100%",width:"100%",zIndex:10},focusIndicator:{display:function(e){return e.focused?"block":"none"},boxShadow:"inset rgba(0, 0, 0, 1) 0 0 0 2px",position:"absolute",height:"100%",width:"100%",zIndex:11}}})),Kn=o.memo((function(e){var t,n=e.file,r=e.selected,i=e.focused,a=e.dndState,l=K.isDirectory(n),c=en(n,r,i),s=Vn(c),d=Jt(n),u=Rt(((t={})[s.gridFileEntry]=!0,t));return o.createElement("div",Object.assign({className:u},d),o.createElement(l?_n:Bn,{className:s.gridFileEntryPreview,entryState:c,dndState:a}),o.createElement("div",{className:s.gridFileEntryNameContainer},o.createElement(En,{className:s.gridFileEntryName,file:n})))}));Kn.displayName="GridEntry";var Vn=zt((function(e){return{gridFileEntry:{flexDirection:"column",display:"flex",height:"100%"},gridFileEntryPreview:{flexGrow:1},gridFileEntryNameContainer:{fontSize:e.gridFileEntry.fontSize,wordBreak:"break-word",textAlign:"center",paddingTop:5},gridFileEntryName:{backgroundColor:function(e){return e.selected?"rgba(0,153,255, .25)":"transparent"},textDecoration:function(e){return e.focused?"underline":"none"},borderRadius:3,padding:[2,4]}}})),qn=o.memo((function(e){var t=e.file,n=e.dndState,i=en(t,e.selected,e.focused),a=tn(n),l=yt(t),c=l.fileModDateString,s=l.fileSizeString,d=r.useMemo((function(){return{entryState:i,dndState:n}}),[n,i]),u=Wn(d),f=Pn(i),p=r.useContext(xt),m=Jt(t);return o.createElement("div",Object.assign({className:u.listFileEntry},m),o.createElement("div",{className:f.focusIndicator}),o.createElement("div",{className:Rt([f.selectionIndicator,u.listFileEntrySelection])}),o.createElement("div",{className:u.listFileEntryIcon},o.createElement(p,{icon:null!=a?a:i.icon,spin:!a&&i.iconSpin,fixedWidth:!0})),o.createElement("div",{className:u.listFileEntryName,title:t?t.name:void 0},o.createElement(En,{file:t})),o.createElement("div",{className:u.listFileEntryProperty},t?null!=c?c:o.createElement("span",null,"—"):o.createElement(Qt,{minLength:5,maxLength:15})),o.createElement("div",{className:u.listFileEntryProperty},t?null!=s?s:o.createElement("span",null,"—"):o.createElement(Qt,{minLength:10,maxLength:20})))})),Wn=zt((function(e){return{listFileEntry:{boxShadow:"inset "+e.palette.divider+" 0 -1px 0",fontSize:e.listFileEntry.fontSize,color:function(t){var n=t.dndState;return n.dndIsOver?n.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:"inherit"},alignItems:"center",position:"relative",display:"flex",height:"100%"},listFileEntrySelection:{opacity:.6},listFileEntryIcon:{color:function(t){var n=t.dndState;return n.dndIsOver?n.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:t.entryState.color},fontSize:e.listFileEntry.iconFontSize,boxSizing:"border-box",padding:[2,4],zIndex:20},listFileEntryName:{textOverflow:"ellipsis",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",flex:"1 1 300px",paddingLeft:8,zIndex:20},listFileEntryProperty:{fontSize:e.listFileEntry.propertyFontSize,boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",flex:"0 1 150px",padding:[2,8],zIndex:20}}})),Gn={dndIsDragging:!1,dndIsOver:!1,dndCanDrop:!1},Un=o.memo((function(e){var t,n=e.fileId,i=e.displayIndex,a=e.fileViewMode,l=Yn(),c=dt(oe,n),d=dt(ue,n),u=s.useSelector(Ce),f=function(e,t){var n=s.useDispatch(),o=r.useCallback((function(r,o){e&&n(Ye(rt.MouseClickFile,{clickType:o,file:e,fileDisplayIndex:t,altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey}))}),[n,e,t]),i=r.useCallback((function(r){e&&n(Ye(rt.KeyboardClickFile,{file:e,fileDisplayIndex:t,enterKey:r.enterKey,spaceKey:r.spaceKey,altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey}))}),[n,e,t]);return{onSingleClick:r.useCallback((function(e){return o(e,"single")}),[o]),onDoubleClick:r.useCallback((function(e){return o(e,"double")}),[o]),onKeyboardClick:i}}(c,i),p=r.useState(!1),m=p[0],g=p[1],h=T({wrapperTag:"div",passthroughProps:{className:l.fileEntryClickableWrapper}},K.isClickable(c)?f:void 0,{setFocused:g}),b={file:c,selected:d,focused:m};return t=a===exports.FileViewMode.List?qn:a===exports.FileViewMode.Compact?Mn:Kn,u?o.createElement(wn,Object.assign({},h),o.createElement(t,Object.assign({},b,{dndState:Gn}))):o.createElement(An,{file:c},(function(e){return o.createElement(wn,Object.assign({},h),o.createElement(t,Object.assign({},b,{dndState:e})))}))}));Un.displayName="SmartFileEntry";var Yn=Tt((function(){return{fileEntryClickableWrapper:{outline:"none !important",position:"relative",height:"100%"}}})),Xn=function(e,t,n,r){var o,i,a=r?5:8,l=void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")?0:18;return r?i=(e-a-l)/(o=2):(i=n.entryWidth,o=Math.max(1,Math.floor((e-l)/(i+a)))),{rowCount:Math.ceil(t/o),columnCount:o,gutter:a,rowHeight:n.entryHeight,columnWidth:i}},Zn=o.memo((function(e){var t=e.width,n=e.height,i=s.useSelector(me),a=s.useSelector(He.getDisplayFileIds),l=r.useMemo((function(){return a.length}),[a]),c=r.useRef(),d=At(),u=r.useState(Xn(t,l,i,d)),f=u[0],p=u[1],m=r.useRef(f);r.useEffect((function(){var e=m.current,n=Xn(t,l,i,d);m.current=n,c.current&&(e.rowCount!==n.rowCount&&c.current.resetAfterRowIndex(Math.min(e.rowCount,n.rowCount)-1),e.columnCount!==n.columnCount&&c.current.resetAfterColumnIndex(Math.min(e.columnCount,n.rowCount)-1),e.columnWidth!==n.columnWidth&&c.current.resetAfterIndices({columnIndex:0,rowIndex:0})),p(n)}),[p,m,d,t,i,l]);var g=r.useMemo((function(){var e=m;return{getColumnWidth:function(t){return e.current.columnWidth+(t===e.current.columnCount-1?0:e.current.gutter)},getRowHeight:function(t){return e.current.rowHeight+(t===e.current.rowCount-1?0:e.current.gutter)}}}),[m]),h=H(s.useSelector(He.getDisplayFileIds)),b=r.useCallback((function(e){var t,n=e.rowIndex*m.current.columnCount+e.columnIndex;return null!=(t=h.current[n])?t:"loading-file-"+n}),[m,h]),y=r.useCallback((function(e){var t=e.rowIndex*m.current.columnCount+e.columnIndex,n=a[t];if(void 0===a[t])return null;var r=T({},e.style,{paddingRight:e.columnIndex===m.current.columnCount-1?0:m.current.gutter,paddingBottom:e.rowIndex===m.current.rowCount-1?0:m.current.gutter,boxSizing:"border-box"});return o.createElement("div",{style:r},o.createElement(Un,{fileId:null!=n?n:null,displayIndex:t,fileViewMode:i.mode}))}),[a,i.mode]),v=Qn();return r.useMemo((function(){return o.createElement(O.VariableSizeGrid,{ref:c,className:v.gridContainer,estimatedRowHeight:f.rowHeight+f.gutter,rowHeight:g.getRowHeight,estimatedColumnWidth:f.columnWidth+f.gutter,columnWidth:g.getColumnWidth,columnCount:f.columnCount,height:n,rowCount:f.rowCount,width:t,itemKey:b},y)}),[v.gridContainer,f.rowHeight,f.gutter,f.columnWidth,f.columnCount,f.rowCount,g.getRowHeight,g.getColumnWidth,n,t,b,y])})),Qn=Tt((function(){return{gridContainer:{}}})),$n=o.memo((function(e){var t=e.width,n=e.height,i=s.useSelector(me),a=r.useRef(),l=s.useSelector(He.getDisplayFileIds),c=H(l),d=r.useCallback((function(e){var t;return null!=(t=c.current[e])?t:"loading-file-"+e}),[c]),u=Jn();return r.useMemo((function(){return o.createElement(O.FixedSizeList,{ref:a,className:u.listContainer,itemSize:i.entryHeight,height:n,itemCount:l.length,width:t,itemKey:d},(function(e){var t;return o.createElement("div",{style:e.style},o.createElement(Un,{fileId:null!=(t=l[e.index])?t:null,displayIndex:e.index,fileViewMode:exports.FileViewMode.List}))}))}),[u.listContainer,i.entryHeight,n,l,t,d])})),Jn=zt((function(e){return{listContainer:{borderTop:"solid 1px "+e.palette.divider}}})),er=o.memo((function(e){var t=s.useSelector(He.getDisplayFileIds),n=s.useSelector(me),i=s.useSelector(ee),a=Xt({file:i}),l=a.drop,c=a.dndCanDrop,d=a.dndIsOverCurrent,u=r.useMemo((function(){return{dndCanDrop:c,dndIsOverCurrent:d}}),[c,d]),f=tr(u),p=nr(n),m=e.onScroll,g=r.useCallback((function(e){var r=e.width,i=e.height;return 0===t.length?o.createElement(Fn,{width:r,height:n.entryHeight}):n.mode===exports.FileViewMode.List?o.createElement($n,{width:r,height:i}):o.createElement(Zn,{width:r,height:i})}),[t,n]),h=r.useContext(xt);return o.createElement("div",{onScroll:m,ref:l,className:Rt([p.fileListWrapper,f.fileListWrapper]),role:"list"},o.createElement("div",{className:f.dndDropZone},o.createElement("div",{className:f.dndDropZoneIcon},o.createElement(h,{icon:c?exports.ChonkyIconName.dndCanDrop:exports.ChonkyIconName.dndCannotDrop}))),o.createElement(A,{disableHeight:!1},g))}));er.displayName="FileList";var tr=zt((function(e){return{fileListWrapper:{minHeight:rt.EnableGridView.fileViewConfig.entryHeight+2,background:function(t){return t.dndIsOverCurrent&&t.dndCanDrop?t.dndCanDrop?Ot(e.dnd.fileListCanDropMaskOne,e.dnd.fileListCanDropMaskTwo):Ot(e.dnd.fileListCannotDropMaskOne,e.dnd.fileListCannotDropMaskTwo):"none"}},dndDropZone:{display:function(e){return e.dndIsOverCurrent&&e.dndCanDrop?"block":"none"},borderRadius:e.gridFileEntry.borderRadius,pointerEvents:"none",position:"absolute",height:"100%",width:"100%",zIndex:2},dndDropZoneIcon:{backgroundColor:function(t){return t.dndCanDrop?e.dnd.canDropMask:e.dnd.cannotDropMask},color:function(t){return t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor},borderRadius:e.gridFileEntry.borderRadius,transform:"translateX(-50%) translateY(-50%)",position:"absolute",textAlign:"center",lineHeight:"60px",fontSize:"2em",left:"50%",height:60,top:"50%",width:60}}})),nr=Tt((function(){return{fileListWrapper:{height:"100%",maxHeight:"100%"}}})),rr=o.memo((function(){var e=s.useDispatch();r.useEffect((function(){return e(ct.setContextMenuMounted(!0)),function(){e(ct.setContextMenuMounted(!1))}}),[e]);var t=l.useIntl().formatMessage({id:gt(exports.I18nNamespace.FileContextMenu,"browserMenuShortcut"),defaultMessage:"Browser menu: {shortcut}"},{shortcut:o.createElement("strong",null,"Alt + Right Click")}),n=s.useSelector(Ie),i=s.useSelector($),a=function(){var e=s.useDispatch();return r.useCallback((function(){return e(ct.hideContextMenu())}),[e])}(),c=r.useMemo((function(){for(var e=[],t=function(t){var n=i[t];"string"==typeof n?e.push(o.createElement(gn,{key:"context-menu-item-"+n,fileActionId:n,onClickFollowUp:a})):n.fileActionIds.map((function(t){return e.push(o.createElement(gn,{key:"context-menu-item-"+n.name+"-"+t,fileActionId:t,onClickFollowUp:a}))}))},n=0;n<i.length;++n)t(n);return e}),[i,a]),d=r.useMemo((function(){return n?{top:n.mouseY,left:n.mouseX}:void 0}),[n]),u=or();return o.createElement(F,{elevation:2,disablePortal:!0,onClose:a,transitionDuration:150,open:!!n,anchorPosition:d,anchorReference:"anchorPosition",classes:{list:u.contextMenuList}},c,o.createElement(z,{component:"div",className:u.browserMenuTooltip},t))})),or=Tt((function(){return{contextMenuList:{paddingBottom:Lt(0),paddingTop:Lt(0)},browserMenuTooltip:{lineHeight:Lt("30px"),fontSize:Lt("0.7em")}}})),ir=o.memo(o.forwardRef((function(e,t){var n=e.onScroll;return o.createElement(Ut,Object.assign({ref:t},e),o.createElement(un,null),o.createElement(Sn,null),o.createElement(er,{onScroll:n}),o.createElement(rr,null))})));ir.displayName="FullFileBrowser";var ar=function(e,t){return r.useMemo((function(){for(var n=e[t],r=[n],o=n.parentId;o;){var i=e[o];if(!i)break;r.unshift(i),o=i.parentId}return r}),[t,e])},lr=function(e,t){return r.useMemo((function(){return e[t].childrenIds.map((function(t){return e[t]}))}),[t,e])},cr=function(e,t){var n=r.useState(e),o=n[0],i=n[1],a=r.useState(t),l=a[0],c=a[1],s=r.useCallback((function(){i(e),c(t)}),[e,t]),d=r.useCallback((function(e,t,n){return i((function(r){var o=T({},r),i=new Set(e.map((function(e){return e.id}))),a=t.childrenIds.filter((function(e){return!i.has(e)}));o[t.id]=T({},t,{childrenIds:a,childrenCount:a.length});var l=[].concat(n.childrenIds,e.map((function(e){return e.id})));return o[n.id]=T({},n,{childrenIds:l,childrenCount:l.length}),e.forEach((function(e){o[e.id]=T({},e,{parentId:n.id})})),o}))}),[]);return{fileMap:o,currentFolderId:l,methods:r.useMemo((function(){return{setFileMap:i,setCurrentFolderId:c,resetFileMap:s,moveFiles:d}}),[i,c,s,d])}},sr=function(e){return r.useCallback((function(t){if(t.id===rt.OpenFiles.id){var n=t.payload,r=n.targetFile,o=null!=r?r:n.files[0];o&&K.isDirectory(o)&&e.setCurrentFolderId(o.id)}else t.id===rt.MoveFiles.id&&e.moveFiles(t.payload.files,t.payload.source,t.payload.destination)}),[e])},dr={__proto__:null,useFolderChain:ar,useFiles:lr,useFileMapMethods:cr,useFileActionHandler:sr,useFileMap:function(e){var t=cr(e.baseFileMap,e.initialFolderId),n=t.fileMap,r=t.currentFolderId,o=t.methods;return{data:{fileMap:n,currentFolderId:r,folderChain:ar(n,r),files:lr(n,r)},methods:o,fileActionHandler:sr(o)}}};exports.ChonkyActions=rt,exports.ChonkyDndFileEntryType="dnd-chonky-file-entry",exports.DefaultFileActions=it,exports.FileBrowser=Ut,exports.FileContextMenu=rr,exports.FileHelper=K,exports.FileList=er,exports.FileNavbar=un,exports.FileToolbar=Sn,exports.FullFileBrowser=ir,exports.OptionIds=q,exports.defaultFormatters=vt,exports.defineFileAction=Qe,exports.fileMap=dr,exports.getActionI18nId=ht,exports.getI18nId=gt,exports.setChonkyDefaults=function(e){for(var t=0,n=Object.keys(mt);t<n.length;t++){var r=n[t];r in e&&(mt[r]=e[r])}},exports.thunkDispatchFileAction=Ue,exports.thunkRequestFileAction=Ye;
//# sourceMappingURL=chonky.cjs.production.min.js.map
